
CREATE DATABASE IF NOT EXISTS cs174;
USE cs174;

DROP TABLE IF EXISTS user;
CREATE TABLE user (
id INT AUTO_INCREMENT,
name VARCHAR(40),
email VARCHAR(50),
password VARCHAR(80),
authenticated BOOLEAN DEFAULT false,
requestedAdd BOOLEAN DEFAULT false,
PRIMARY KEY(id, email)
);

DROP TABLE IF EXISTS admin;
CREATE TABLE admin (
id INT AUTO_INCREMENT,
firstname VARCHAR(40),
lastname VARCHAR(40),
email VARCHAR(50),
password VARCHAR(80),
PRIMARY KEY(id, email)
);

DROP TABLE IF EXISTS usermalware;
CREATE TABLE usermalware (
name VARCHAR(128),
signature VARCHAR(200) PRIMARY KEY
);

DROP TABLE IF EXISTS malware;
CREATE TABLE malware (
name VARCHAR(128),
signature VARCHAR(200) PRIMARY KEY
);

DROP TRIGGER IF EXISTS addMalware;
DELIMITER //
CREATE TRIGGER addMalware
AFTER DELETE ON usermalware
FOR EACH ROW
BEGIN
INSERT INTO malware (name, signature) VALUES (old.name, old.signature);
END;//
DELIMITER ;
